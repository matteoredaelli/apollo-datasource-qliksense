* apollo-datasource-qliksense

  apollo-datasource-qliksense is a apollo datasource for Qliksense


** Installation

   npm install apollo-datasource-qliksense

** Usage

   Below a very basic sample

File index.js file:

#+BEGIN_SRC javascript
const resolvers = require('./resolvers');

const { ApolloServer, gql } = require('apollo-server');
const { makeExecutableSchema } = require('graphql-tools');
const { QliksenseDataSource } = require('apollo-datasource-qliksense');

const qliksense = new QliksenseDataSource("https://myqlikserver.redaelli.org:4242",
				process.env.QLIK_CERTIFICATE,
				process.env.QLIK_CERTIFICATE_KEY);

const { readFileSync } = require('fs')

const typeDefs = readFileSync('./schema.txt').toString('utf-8')


const graphqlSchemaObj = { //makeExecutableSchema({
    typeDefs: typeDefs,
    resolvers: resolvers,
    tracing: true,
    dataSources: () => ({ qliksense: qliksense })
};
// The ApolloServer constructor requires two parameters: your schema
// definition and your set of resolvers.
const server = new ApolloServer(graphqlSchemaObj);

// The `listen` method launches a web server.
server.listen().then(({ url }) => {
  console.log(`ðŸš€  Server ready at ${url}`);
});
#+END_SRC

File schema.graphql

#+BEGIN_SRC graphql
type Json {
     json: String
     }

type Query {
  qliksense_entity(
    entity: String!,
    count: Boolean,
    filter:String): Json
}
#+END_SRC

File resolverrs.js

#+BEGIN_SRC javascript
module.exports = {
  Query: {
      qliksense_entity: async (_source, { entity, count, filter }, { dataSources }) => {
	  resp = await dataSources.qliksense.getEntity(entity, count, filter);
	  return {json:  JSON.stringify(resp) }
      },
  },
}
#+END_SRC

Sample graphql queries

#+BEGIN_SRC graphql
{
  qliksense_entity(
    entity: "custompropertydefinition"
    filter: "Name eq 'GroupAccess'"
  ) {
    json
  }
}

#+END_SRC

#+BEGIN_SRC graphql
{
  qliksense_entity(
    entity: "user"
    count: true
  ) {
    json
  }
}

#+END_SRC
** Qliksense graphql schema

   For building an useful schema for Qliksense, I suggest the tool https://github.com/walmartlabs/json-to-simple-graphql-schema
   With a sampel json file (foran export of customproperty
